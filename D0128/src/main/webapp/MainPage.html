<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Main Page</title>
    <link rel="stylesheet" href="css/MainPage.css" />

    <script src="js/jquery-3.6.0.min.js"></script>	
	<script src="js/core.js"></script>
	</head>
  <body>
    <div class="header">
      <h1>MOLE</h1>
    </div>

    <div class="main-container">
      <div class="ongoing-projects">
        <h2>On Going</h2>
        <div class="project-list"></div>
      </div>
      <div>
        <div class="recent-and-gantt">
          <div class="box-col">
            <h2 class="title">recent issue</h2>
            <div class="recent-issue-container">
              <div class="recent-issues">
                <div class="issue">issue: something on svelte</div>
                <div class="issue">issue: something on svelte</div>
                <div class="issue">issue: something on svelte</div>
              </div>
            </div>
          </div>

          <div class="box-col">
            <h2 class="title">Gantt Chart</h2>
            <div class="gantt-chart-container">
              <div class="chart">
                <div>Example Block A</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<script>
  $(document).ready(function () {
    loadProjects(); // 페이지 로드 시 프로젝트 목록 불러오기
  });

  function loadProjects() {
	    $.ajax({
	        url: "jsp/GetProjectList.jsp",
	        type: "GET",
	        dataType: "json",
	        success: function (projects) {
	            console.log("✅ 프로젝트 데이터 수신:", projects); // ← AJAX 응답 데이터 확인
	            showProjects(projects);
	        },
	        error: function (xhr, status, error) {
	            console.error("❌ AJAX 오류 발생:", error);
	        },
	    });
	}


  function showProjects(projects) {
    var projectContainer = $(".project-list");
    projectContainer.empty(); // 기존 리스트 초기화

    if (projects.length > 0) {
      for (var i = 0; i < projects.length; i++) {
        projectContainer.append(getProjectCode(projects[i])); // 프로젝트 UI 생성
      }
    } else {
      projectContainer.append("<p>No On Going Projects</p>"); // 데이터 없을 때 메시지 표시
    }
  }

  function getProjectCode(project) {
    var name = project.name ? project.name : "Unnamed Project"; 

    var str = "<div class='project'>";
    str += "<h3>" + name + "</h3>";
    str += "<p>Created At: " + project.created_at + "</p>";
    str += "</div>";

    return str;
  }
</script>
